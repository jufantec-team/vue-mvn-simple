# web-console

> 新版前端框架原型

## Build Setup

``` bash
#使用官方 npm 安装连接国外镜像会比较，推荐安装淘宝镜像的 cnpm 工具

# install dependencies
npm install （或 cnpm install）

# serve with hot reload at localhost:8080
npm run dev

# build for production with minification
npm run build
```

##运行说明

>用户名 / 密码：admin / 123123

>左侧菜单只有 【测试】 部分有内容

##关于该原型

>界面随便写的，没有做美化，功能也不完善大致可看出个样子，会存在很多用户交互上的不足，这以上都不是该原型探讨的重点。

>原型简单实现了：树型菜单加载、权限控制、服务端交互封闭、页面路由等。

>计划所有开发人员分模块不断完善原型，最终形成新版前端框架。

###服务端

>服务端还是 java-web 项目，接入前需将 master 分支更新到最新，然后修改 ./config/index.js 文件 dev.proxyTable.target 项为自己电脑的 tomcat 地址。

>如果未接入服务端，只能看到页面，不能获取到数据。

>该原型前端开发模式自带web服务，使用了 node http-proxy-middleware 库代理服务端，处理ajax请求。

###集成的前端框架

>核心：vue

>页面路由：vue-router

>状态库：vuex

>ajax请求：vue-resource

>UI库：element-ui

>前端资源模块化管理和打包工具：webpack

>js语法：es6、promise，这两个功能不能做框架，但是也非常重要

>以上是主要依赖库，其它vue开发环境的n多依赖不再列举。需注意, jquery 已经不再使用了.

##遇到的坑

>vue官方推荐的脚手架工具 vue-cli 创建的示例项目 webpack ，集成了很多工具，使用很方便，但是 webpack 版本是1.13，该版本在动态加载模板时无法有效获取加载状态，即加载失败时没有回调，在webpack 2.0版本以上时该问题已解决，但是无法与 vue-cli 的示例项目集成，尝试了很多办法也没集成成功，最终用了一种不太优美的方式处理。

>element-ui框架的tabs控件绑定数据修改时与vue冲突

>vue-resource 的timeout属性无效, 如果官方不修复, 可以自己写补丁实现.

>在对框架持续使用的过程中, 肯定还有遇到更多的坑, 遇到了就想办法解决即可.

##还需完善的地方

>1.登录时没有连接数据库检验用户名和密码

>2.左侧导航菜单与权限配置没有从数据库加载, 见./data 目录中的两个json文件, 需要时把数据库中的数据按照该格式整理即可.

>3.多页面切换的 tabs 实现不完善, 使用的 element-ui 库的控件有缺陷, 需要自己实现. 另, 关闭页面时特定情况有bug.

>4.界面不美观, 不能自适应不同高度的屏幕

>5.权限判断没有服务端参与, 不够严谨.

>6.界面有点不太协调.

>7.未集成单元测试框架.

>8.很多基础功能未封装.

##封装思路

>1.一个功能就菜单是一个 vue 模板文件, 复杂的功能可在文件中引用其它的模板.

>2.进入页面时只加载基础的js库与模板文件, 点击菜单中的导航时动态加载需要的模板文件. 该功能已官方推荐的方式实现, 但是并没有真正打包测试, 网上有人说该方式并没有实现真正的动态加载.

>3.以下情况必须使用 vuex 状态库管理变量: 全局变量、非父子组件之间传递数据、缓存st-table-paramet参数表信息等, 依照vuex规范封装成 module .

>4.自己封装的功能保存在 ./api 目录, 最终遵从 vue 插件规范加载到 vue 全局变量中.

>5.项目目录结构: store目录为vuex状态库支持, router目录为路由支持, data目录为原型期的测试数据, components为模板文件目录, api为自己封装的功能插件, assets为静态资源目录

>6.与服务端交互使用 application/json 格式, 目前支持了现有后端框架, 等开始设计新版后端框架时, 需要支持完整 rest 风格api.

>7.最终将项目封装成模板, 以后每个项目使用官方脚手架 vue-cli 客户端创建即可, 不再需要来回copy代码.

>8.一些功能可以对element的模板进行二次封装，比如已在st_table_paramet中配置的下拉列表，用于显示st_table_paramet配置中文说明的标签与表格单元格。

##关于 vue

>随着js越来越完善, 使用场景越来越多, js能力也越来越重要, 想做出良好用户体验的系统, 必须摒弃不想写太多js的思想.

>前端框架选择 vue , 以我这段时间的使用感受来讲, 在减少代码量与自由操作dom对象两个方面做的都非常好, 以往的框架想自由的使用dom开发交互性好的页面, 就要写更多的js代码; 使用更少的js代码, 就只能使用已封装好的函数避免直接操作dom, vue对这两方面的结合非常好.

>这也带来了一个新问题, 开发会加重向两极分化, 代码能力强的人做的页面会更好, 代码能力差的人做页面可能还不如公司现有框架的效果好.

>在学习阶段, 可以从网上找一找学习路线, 把vue官方的例子都看完, 距离写框架级的代码还很远.


#版本升级说明

2017-2-16 增加了 json orm 接口，调用示例见 test4.vue， 源码见 api/data-template.js
